<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Writeup | Tiziano Caruana</title>
<meta name="keywords" content="">
<meta name="description" content="Tiziano Caruana&#39;s personal website">
<meta name="author" content="">
<link rel="canonical" href="https://Tiziano-Caruana.github.io/tags/writeup/">
<meta name="google-site-verification" content="-NRlyU37XYTZJ4WyeO8svRuXL8xXbOUAqLrx-qYbEpw">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d72444526d7ecbdb0015438a7fa89054a658bf759d0542e2e5df81ce94b493ee.css" integrity="sha256-1yREUm1&#43;y9sAFUOKf6iQVKZYv3WdBULi5d&#43;BzpS0k&#43;4=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNvCmIE7HEiLhByQCf2_uMI9ENQNto_kSmOjKv-BusCjO355SvJeQZmWMPBXS6wwaH7nQ&amp;usqp=CAU">
<link rel="icon" type="image/png" sizes="16x16" href="https://Tiziano-Caruana.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://Tiziano-Caruana.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://Tiziano-Caruana.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://Tiziano-Caruana.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://Tiziano-Caruana.github.io/tags/writeup/index.xml">
<link rel="alternate" hreflang="en" href="https://Tiziano-Caruana.github.io/tags/writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://Tiziano-Caruana.github.io/tags/writeup/">
  <meta property="og:site_name" content="Tiziano Caruana">
  <meta property="og:title" content="Writeup">
  <meta property="og:description" content="Tiziano Caruana&#39;s personal website">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Writeup">
<meta name="twitter:description" content="Tiziano Caruana&#39;s personal website">

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://Tiziano-Caruana.github.io/" accesskey="h" title="Tiziano Caruana (Alt + H)">Tiziano Caruana</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://Tiziano-Caruana.github.io/it/" title="Italiano"
                            aria-label="Italiano">Italiano</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://Tiziano-Caruana.github.io/about_me" title="About me">
                    <span>About me</span>
                </a>
            </li>
            <li>
                <a href="https://Tiziano-Caruana.github.io/tags/blog" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://Tiziano-Caruana.github.io/tags/writeup" title="Writeup">
                    <span class="active">Writeup</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://Tiziano-Caruana.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://Tiziano-Caruana.github.io/tags/">Tags</a></div>
  <h1>
    Writeup
    <a href="/tags/writeup/index.xml" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Perfect Shop - OpenECSC 2024
    </h2>
  </header>
  <div class="entry-content">
    <p>Perfect Shop March 2024 - filtered and size-limited reflected XSS
“Do you like perfect things? Check out my new online shop!”
Prior knowledge: HTML, JavaScript
Context The link to the challenge website and its corresponding source code are provided. At first glance, the website may seem a bit overwhelming: there are various functionalities, which means several endpoints and mechanisms to study in search of vulnerabilities.
However, fortunately, the code is relatively short and not very verbose, and all files except for server.js do not contain interesting elements: products.js gathers information about the products, while the various templates seem to only display elements passed by the server. Their presence can be kept in mind, but the existence of a Server Side Template Injection is temporarily ruled out.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-03-27 22:20:00 +0200 +0200'>March 27, 2024</span>&nbsp;·&nbsp;26 min&nbsp;·&nbsp;5526 words</footer>
  <a class="entry-link" aria-label="post link to Perfect Shop - OpenECSC 2024" href="https://Tiziano-Caruana.github.io/posts/writeups/openecsc-2024/perfect_shop/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Penguin Login - LACTF 2024
    </h2>
  </header>
  <div class="entry-content">
    <p>penguin-login February 2024 - Blind SQL injection
“I got tired of people leaking my password from the db so I moved it out of the db.”
Prior knowledge: basic web-related knowledge, SQL
Context We are provided with the link to the challenge website and the corresponding source code. The website is quite simple, and the usage of its features is straightforward: All the code is in app.py:
... allowed_chars = set(string.ascii_letters &#43; string.digits &#43; &#34; &#39;flag{a_word}&#39;&#34;) forbidden_strs = [&#34;like&#34;] @cache def get_database_connection(): # Get database credentials from environment variables db_user = os.environ.get(&#34;POSTGRES_USER&#34;) db_password = os.environ.get(&#34;POSTGRES_PASSWORD&#34;) db_host = &#34;db&#34; # Establish a connection to the PostgreSQL database connection = psycopg2.connect(user=db_user, password=db_password, host=db_host) return connection with app.app_context(): conn = get_database_connection() create_sql = &#34;&#34;&#34; DROP TABLE IF EXISTS penguins; CREATE TABLE IF NOT EXISTS penguins ( name TEXT ) &#34;&#34;&#34; with conn.cursor() as curr: curr.execute(create_sql) curr.execute(&#34;SELECT COUNT(*) FROM penguins&#34;) if curr.fetchall()[0][0] == 0: curr.execute(&#34;INSERT INTO penguins (name) VALUES (&#39;peng&#39;)&#34;) curr.execute(&#34;INSERT INTO penguins (name) VALUES (&#39;emperor&#39;)&#34;) curr.execute(&#34;INSERT INTO penguins (name) VALUES (&#39;%s&#39;)&#34; % (flag)) conn.commit() @app.post(&#34;/submit&#34;) def submit_form(): try: username = request.form[&#34;username&#34;] conn = get_database_connection() assert all(c in allowed_chars for c in username), &#34;no character for u uwu&#34; assert all( forbidden not in username.lower() for forbidden in forbidden_strs ), &#34;no word for u uwu&#34; with conn.cursor() as curr: curr.execute(&#34;SELECT * FROM penguins WHERE name = &#39;%s&#39;&#34; % username) result = curr.fetchall() if len(result): return &#34;We found a penguin!!!!!&#34;, 200 return &#34;No penguins sadg&#34;, 201 except Exception as e: return f&#34;Error: {str(e)}&#34;, 400 # need to commit to avoid connection going bad in case of error finally: conn.commit() ... We know that the website uses Postgres as the RDBMS/SQL database, and that the flag is contained in the penguins table along with the penguins.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-02-18 22:20:00 +0200 +0200'>February 18, 2024</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1752 words</footer>
  <a class="entry-link" aria-label="post link to Penguin Login - LACTF 2024" href="https://Tiziano-Caruana.github.io/posts/writeups/lactf-2024/penguin_login/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Flag Shop - HSCTF 2023
    </h2>
  </header>
  <div class="entry-content">
    <p>June 2023 - Blind NoSQL injection
“hsctf pay to win confirmed?”
Prior knowledge: basic web-related knowledge, Burpsuite
Context We are provided with the link to the website and its corresponding source code. The website appears to be very simple, and the source code is quite short:
Content of app.py:
import os import traceback import pymongo.errors from flask import Flask, jsonify, render_template, request from pymongo import MongoClient app = Flask(__name__) FLAG = os.getenv(&#34;FLAG&#34;) app.config[&#34;SECRET_KEY&#34;] = os.getenv(&#34;FLASK_SECRET&#34;) mongo_client = MongoClient(connect=False) db = mongo_client.database @app.route(&#34;/&#34;) def main(): return render_template(&#34;index.html&#34;) @app.route(&#34;/api/search&#34;, methods=[&#34;POST&#34;]) def search(): if request.json is None or &#34;search&#34; not in request.json: return jsonify({&#34;error&#34;: &#34;No search provided&#34;, &#34;results&#34;: []}), 400 try: results = db.flags.find( { &#34;$where&#34;: f&#34;this.challenge.includes(&#39;{request.json[&#39;search&#39;]}&#39;)&#34; }, { &#34;_id&#34;: False, &#34;flag&#34;: False } ).sort(&#34;challenge&#34;) except pymongo.errors.PyMongoError: traceback.print_exc() return jsonify({&#34;error&#34;: &#34;Database error&#34;, &#34;results&#34;: []}), 500 return jsonify({&#34;error&#34;: &#34;&#34;, &#34;results&#34;: list(results)}), 200 if __name__ == &#34;__main__&#34;: app.run() So we know that the website uses MongoDB as its (NoSQL) database.
...</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-14 22:20:00 +0200 CEST'>July 14, 2023</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1329 words</footer>
  <a class="entry-link" aria-label="post link to Flag Shop - HSCTF 2023" href="https://Tiziano-Caruana.github.io/posts/writeups/hsctf-2023/flagshop_hsctf/"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://Tiziano-Caruana.github.io/">Tiziano Caruana</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
